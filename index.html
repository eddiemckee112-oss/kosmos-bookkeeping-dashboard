<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Kosmos Bookkeeping ‚Äî Dashboard</title>
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <style>
    :root {
      --bg:#fafafa; --card:#fff; --border:#e5e7eb;
      --muted:#6b7280; --ok:#0a7a33; --err:#b00020;
      --ink:#111; --btn:#111; --btnH:#333;
    }
    *{box-sizing:border-box;}
    body{
      font-family:system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      margin:0; background:var(--bg); color:var(--ink);
    }
    header{
      background:#fff; border-bottom:1px solid var(--border);
      padding:14px 24px; display:flex; justify-content:space-between; align-items:center;
      position:sticky; top:0; z-index:10;
    }
    header h1{ font-size:1.2rem; margin:0; }
    nav a{
      margin-left:16px; color:var(--ink); text-decoration:none; font-weight:500;
      padding:6px 10px; border-radius:8px;
    }
    nav a:hover, nav a.active{ background:#111; color:#fff; }
    main{ padding:32px; max-width:1000px; margin:auto; }
    h2{ margin-top:0; }
    .grid{ display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:16px; }
    .card{
      background:var(--card); border:1px solid var(--border);
      border-radius:14px; padding:20px; text-align:center;
      box-shadow:0 2px 6px rgba(0,0,0,0.04);
    }
    .value{ font-size:2rem; font-weight:700; margin:8px 0; }
    .muted{ color:var(--muted); }
    .ok{ color:var(--ok); }
    .err{ color:var(--err); }
    .actions{ margin-top:30px; text-align:center; }
    button{
      padding:.7rem 1.2rem; border-radius:10px; border:1px solid #bbb;
      background:var(--btn); color:#fff; cursor:pointer;
      margin:0 8px; font-size:15px;
    }
    button:hover{ background:var(--btnH); }
    footer{ margin-top:60px; text-align:center; color:var(--muted); font-size:13px; }
  </style>
</head>
<body>
  <header>
    <h1>üìä Kosmos Bookkeeping</h1>
    <nav>
      <a href="index.html" class="active">Dashboard</a>
      <a href="receipts.html">Receipts</a>
      <a href="transactions.html">Transactions</a>
      <a href="reports.html">Reports</a>
    </nav>
  </header>

  <main>
    <h2>Dashboard Overview</h2>
    <p class="muted">Snapshot of your bookkeeping data. Auto-refresh coming soon.</p>

    <div class="grid" style="margin-top:24px;">
      <div class="card">
        <div class="muted">Total Receipts</div>
        <div id="receiptCount" class="value">‚Äî</div>
      </div>
      <div class="card">
        <div class="muted">Total Transactions</div>
        <div id="txnCount" class="value">‚Äî</div>
      </div>
      <div class="card">
        <div class="muted">Matched Pairs</div>
        <div id="matchCount" class="value">‚Äî</div>
      </div>
      <div class="card">
        <div class="muted">Last Updated</div>
        <div id="lastUpdated" class="value" style="font-size:1.1rem;">‚Äî</div>
      </div>
    </div>

    <div class="actions">
      <button onclick="window.location='receipts.html'">üì∏ Go to Receipts</button>
      <button onclick="window.location='transactions.html'">üí≥ Go to Transactions</button>
      <button onclick="window.location='reports.html'">üìÅ Accountant Report</button>
    </div>

    <footer>
      Kosmos Bookkeeping v3 ‚Ä¢ Audit-ready foundation ‚Ä¢ Powered by Supabase
    </footer>
  </main>

  <script>
    const SUPABASE_URL = "https://advihqhjjlxumgdlbwui.supabase.co";
    const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFkdmlocWhqamx4dW1nZGxid3VpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjEwMTg0MzIsImV4cCI6MjA3NjU5NDQzMn0.kVlaPQg2_o9DGJYv22Dgca7veok4drF6kgLPy2wPBeY";
    const sb = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    async function loadStats() {
      try {
        const [r1, r2, r3] = await Promise.all([
          sb.from("receipts").select("*", { count: "exact", head: true }),
          sb.from("transactions").select("*", { count: "exact", head: true }),
          sb.from("matches").select("*", { count: "exact", head: true })
        ]);
        const receipts = r1.count ?? 0;
        const txns = r2.count ?? 0;
        const matches = r3.count ?? 0;

        document.getElementById("receiptCount").textContent = receipts;
        document.getElementById("txnCount").textContent = txns;
        document.getElementById("matchCount").textContent = matches;

        const now = new Date().toLocaleString();
        document.getElementById("lastUpdated").textContent = now;
      } catch (err) {
        console.error(err);
        document.getElementById("lastUpdated").textContent = "Error loading stats";
      }
    }

    loadStats();
  </script>
</body>
</html>
