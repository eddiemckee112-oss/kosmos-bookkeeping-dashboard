<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Kosmos Bookkeeping</title>
    <style>
      body { font-family: system-ui, Arial, sans-serif; margin: 32px; }
      .card { border: 1px solid #ddd; border-radius: 12px; padding: 16px; max-width: 520px; }
      .muted { color: #555; }
    </style>
  </head>
  <body>
    <h1>Kosmos Bookkeeping</h1>
    <div class="card">
      <p id="status" class="muted">Connecting…</p>
      <p id="countBox" style="display:none;">
        <strong>Receipts in database:</strong> <span id="count">0</span>
      </p>
    </div>

    <!-- Supabase JS v2 (CDN) -->
    <script src="https://esm.sh/@supabase/supabase-js@2"></script>
    <script>
      // Your project credentials
      const SUPABASE_URL = "https://advihqhjjlxumgdlbwui.supabase.co";
      const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFkdmlocWhqamx4dW1nZGxid3VpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjEwMTg0MzIsImV4cCI6MjA3NjU5NDQzMn0.kVlaPQg2_o9DGJYv22Dgca7veok4drF6kgLPy2wPBeY";

      // Init client
      const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

      // Read count from public.receipts and show it
      async function showCount() {
        const statusEl = document.getElementById("status");
        const countEl = document.getElementById("count");
        const boxEl = document.getElementById("countBox");

        statusEl.textContent = "Reading receipts…";

        const { count, error } = await supabase
          .from("receipts")
          .select("*", { count: "exact", head: true });

        if (error) {
          statusEl.textContent = "Error: " + (error.message || String(error));
          return;
        }

        statusEl.textContent = "Connected.";
        countEl.textContent = (count ?? 0).toString();
        boxEl.style.display = "block";
      }

      showCount();
    </script>
  </body>
</html>
