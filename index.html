<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Kosmos ‚Äî Dashboard</title>

  <!-- Shared theme -->
  <link rel="stylesheet" href="style.css" />

  <!-- Supabase -->
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>

  <style>
    /* page-local */
    .actions{ display:flex; gap:12px; flex-wrap:wrap; justify-content:center; }
    .hero{ text-align:center; margin-bottom:16px; }
  </style>
</head>
<body>
  <!-- Header -->
  <header>
    <h1>Kosmos Bookkeeping</h1>
    <nav>
      <a href="index.html" class="active">Dashboard</a>
      <a href="receipts.html">Receipts</a>
      <a href="transactions.html">Transactions</a>
      <a href="reports.html">Reports</a>
    </nav>
  </header>

  <!-- Main -->
  <main class="container">
    <div class="hero">
      <h2>Dashboard Overview</h2>
      <p class="muted">Snapshot of your bookkeeping data. Auto-refresh coming soon.</p>
    </div>

    <!-- Stats -->
    <section class="stats">
      <div class="card stat">
        <small>Total Receipts</small>
        <h3 id="statReceipts">‚Äî</h3>
      </div>
      <div class="card stat">
        <small>Total Transactions</small>
        <h3 id="statTxns">‚Äî</h3>
      </div>
      <div class="card stat">
        <small>Matched Pairs</small>
        <h3 id="statMatches">‚Äî</h3>
      </div>
      <div class="card stat">
        <small>Last Updated</small>
        <h3 id="statUpdated">‚Äî</h3>
      </div>
    </section>

    <!-- Shortcuts -->
    <div class="card" style="margin-top:16px;">
      <div class="actions">
        <a class="ghost" href="receipts.html"><button class="ghost">üßæ Go to Receipts</button></a>
        <a class="ghost" href="transactions.html"><button class="ghost">üí≥ Go to Transactions</button></a>
        <a class="ghost" href="reports.html"><button class="ghost">üìÅ Accountant Report</button></a>
      </div>
    </div>

    <p class="muted" style="text-align:center;margin-top:16px;">
      Kosmos Bookkeeping v3 ‚Ä¢ Audit-ready foundation ‚Ä¢ Powered by Supabase
    </p>
  </main>

  <!-- Script -->
  <script>
    const SUPABASE_URL = "https://advihqhjjlxumgdlbwui.supabase.co";
    const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFkdmlocWhqamx4dW1nZGxid3VpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjEwMTg0MzIsImV4cCI6MjA3NjU5NDQzMn0.kVlaPQg2_o9DGJYv22Dgca7veok4drF6kgLPy2wPBeY";
    const sb = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    const $ = (id) => document.getElementById(id);

    async function loadStats(){
      // receipts count
      const r = await sb.from("receipts").select("id", { count: "exact", head: true });
      // transactions count
      const t = await sb.from("transactions").select("id", { count: "exact", head: true });
      // matches count
      const m = await sb.from("matches").select("id", { count: "exact", head: true });

      $("statReceipts").textContent = r.count ?? "0";
      $("statTxns").textContent     = t.count ?? "0";
      $("statMatches").textContent  = m.count ?? "0";

      const d = new Date();
      const time = d.toLocaleString([], { year:"numeric", month:"2-digit", day:"2-digit",
                                          hour:"2-digit", minute:"2-digit", hour12:true });
      $("statUpdated").textContent = time.replace(",", "");
    }

    loadStats();
  </script>
<script src="roles.js"></script>
</body>
</html>
